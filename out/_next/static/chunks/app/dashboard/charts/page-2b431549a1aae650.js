(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[947],{13506:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>g});var s=a(95155),t=a(12115),r=a(18999),n=a(6874),i=a.n(n),c=a(138),u=a(81115),m=a(30285),d=a(30548),h=a(29898),o=a(12543),x=a(4913),f=a(59409),b=a(85057);let j=[{label:"Ostatnie dane",value:0},{label:"10 sekund",value:10},{label:"30 sekund",value:30},{label:"1 minuta",value:60},{label:"3 minuty",value:180},{label:"10 minut",value:600},{label:"30 minut",value:1800},{label:"1 godzina",value:3600},{label:"3 godziny",value:10800},{label:"1 dzień",value:86400},{label:"3 dni",value:259200},{label:"1 tydzień",value:604800},{label:"1 miesiąc",value:2592e3},{label:"3 miesiące",value:7776e3}],p=e=>{if(e.length<=1e3)return e;let l=[],a=Math.floor(e.length/1e3);for(let s=0;s<e.length;s+=a)l.push(e[s]);return l[l.length-1]!==e[e.length-1]&&l.push(e[e.length-1]),l};function v(){let e=(0,r.useSearchParams)().get("station"),l=(0,c.tm)(),[a,n]=(0,t.useState)([]),[x,v]=(0,t.useState)(!0),[g,w]=(0,t.useState)(86400);(0,t.useEffect)(()=>{if(!l||!e)return void v(!1);v(!0);let a=(0,u.KR)(l,"users/".concat(e,"/weather_data")),s=(0,u.P)(a),t=(0,u.Zy)(s,e=>{e.exists()?n(Object.entries(e.val()).map(e=>{let[l,a]=e;return{id:l,...a,timestamp:new Date(a.timestamp).toISOString()}}).sort((e,l)=>new Date(e.timestamp).getTime()-new Date(l.timestamp).getTime())):n([]),v(!1)},e=>{console.error("Firebase read error (historical):",e),n([]),v(!1)});return()=>t()},[l,e]);let{historicalWeather:N,samplingInterval:y}=(0,t.useMemo)(()=>{let e=a;if(0!==g){let l=Date.now()-1e3*g;e=a.filter(e=>new Date(e.timestamp).getTime()>=l)}let l=e.length>1e3,s=l?Math.floor(e.length/1e3):null;return{historicalWeather:l?p(e):e,samplingInterval:s}},[a,g]);if(!e)return(0,s.jsxs)("div",{className:"flex h-screen w-full flex-col items-center justify-center bg-background",children:[(0,s.jsx)("p",{className:"mb-4",children:"Nie wybrano stacji."}),(0,s.jsx)(i(),{href:"/dashboard",passHref:!0,children:(0,s.jsxs)(m.$,{variant:"outline",children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Powr\xf3t do pulpitu"]})})]});let k=(0,t.useMemo)(()=>a.some(e=>void 0!==e.pressure),[a]);return(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-background",children:[(0,s.jsx)(d.Y,{}),(0,s.jsxs)("main",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 border-b pb-4",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold",children:["Pełny ekran - Wykresy dla stacji: ",(0,s.jsx)("span",{className:"text-primary",children:e})]}),(0,s.jsxs)("div",{className:"flex items-end gap-4",children:[(0,s.jsxs)("div",{className:"max-w-xs flex-grow",children:[(0,s.jsx)(b.J,{htmlFor:"limit-select",children:"Zakres danych"}),(0,s.jsxs)(f.l6,{onValueChange:e=>w(Number(e)),value:String(g),children:[(0,s.jsx)(f.bq,{id:"limit-select",className:"w-full",children:(0,s.jsx)(f.yv,{})}),(0,s.jsx)(f.gC,{children:j.map(e=>(0,s.jsx)(f.eb,{value:String(e.value),children:e.label},e.value))})]})]}),(0,s.jsx)(i(),{href:"/dashboard",passHref:!0,children:(0,s.jsxs)(m.$,{variant:"outline",children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Powr\xf3t do pulpitu"]})})]})]}),(0,s.jsx)(h.w,{weatherData:N,isLoading:x,hasPressureData:k,timeRange:g,samplingInterval:y})]})]})}function g(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsxs)("div",{className:"flex h-screen w-full flex-col items-center justify-center bg-background",children:[(0,s.jsx)(x.A,{className:"h-12 w-12 animate-spin"}),(0,s.jsx)("p",{className:"mt-4",children:"Ładowanie wykres\xf3w..."})]}),children:(0,s.jsx)(v,{})})}},44526:(e,l,a)=>{Promise.resolve().then(a.bind(a,13506))}},e=>{var l=l=>e(e.s=l);e.O(0,[992,507,644,874,743,38,140,673,441,684,358],()=>l(44526)),_N_E=e.O()}]);