(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{44680:(e,a,t)=>{Promise.resolve().then(t.bind(t,69594))},69594:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>eN});var s=t(95155),l=t(12115),n=t(6874),r=t.n(n),o=t(138),i=t(81115),c=t(66695),d=t(30548),m=t(29898),u=t(59409),x=t(30285),p=t(62278),f=t(59434);let h=p.bL,j=p.l9,g=p.ZL,y=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(p.hJ,{className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:a})});y.displayName=p.hJ.displayName;let w=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsxs)(g,{children:[(0,s.jsx)(y,{}),(0,s.jsx)(p.UC,{ref:a,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l})]})});w.displayName=p.UC.displayName;let N=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};N.displayName="AlertDialogHeader";let b=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};b.displayName="AlertDialogFooter";let v=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(p.hE,{ref:a,className:(0,f.cn)("text-lg font-semibold",t),...l})});v.displayName=p.hE.displayName;let k=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(p.VY,{ref:a,className:(0,f.cn)("text-sm text-muted-foreground",t),...l})});k.displayName=p.VY.displayName;let z=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(p.rc,{ref:a,className:(0,f.cn)((0,x.r)(),t),...l})});z.displayName=p.rc.displayName;let A=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(p.ZD,{ref:a,className:(0,f.cn)((0,x.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...l})});A.displayName=p.ZD.displayName;var S=t(85057),B=t(88628),C=t(77223),R=t(53238),_=t(12543),W=t(86378),E=t(23640),Z=t(36936),L=t(56603),D=t(84220),O=t(31717),I=t(67270),F=t(4913),P=t(21887),T=t(50172),U=t(10518),M=t(77740),J=t(75074),G=t(45821),K=t(25318);G.bL,G.l9;let V=G.ZL;G.bm;let Y=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(G.hJ,{ref:a,className:(0,f.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});Y.displayName=G.hJ.displayName,l.forwardRef((e,a)=>{let{className:t,children:l,...n}=e;return(0,s.jsxs)(V,{children:[(0,s.jsx)(Y,{}),(0,s.jsxs)(G.UC,{ref:a,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[l,(0,s.jsxs)(G.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(K.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}).displayName=G.UC.displayName,l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(G.hE,{ref:a,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})}).displayName=G.hE.displayName,l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(G.VY,{ref:a,className:(0,f.cn)("text-sm text-muted-foreground",t),...l})}).displayName=G.VY.displayName;let q=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(M.uB,{ref:a,className:(0,f.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...l})});q.displayName=M.uB.displayName;let H=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(J.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(M.uB.Input,{ref:a,className:(0,f.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...l})]})});H.displayName=M.uB.Input.displayName;let $=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(M.uB.List,{ref:a,className:(0,f.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...l})});$.displayName=M.uB.List.displayName;let X=l.forwardRef((e,a)=>(0,s.jsx)(M.uB.Empty,{ref:a,className:"py-6 text-center text-sm",...e}));X.displayName=M.uB.Empty.displayName;let Q=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(M.uB.Group,{ref:a,className:(0,f.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...l})});Q.displayName=M.uB.Group.displayName,l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(M.uB.Separator,{ref:a,className:(0,f.cn)("-mx-1 h-px bg-border",t),...l})}).displayName=M.uB.Separator.displayName;let ee=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,s.jsx)(M.uB.Item,{ref:a,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l})});ee.displayName=M.uB.Item.displayName;var ea=t(98176);let et=ea.bL,es=ea.l9,el=l.forwardRef((e,a)=>{let{className:t,align:l="center",sideOffset:n=4,...r}=e;return(0,s.jsx)(ea.ZL,{children:(0,s.jsx)(ea.UC,{ref:a,align:l,sideOffset:n,className:(0,f.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})});function en(e){let{selectedCity:a,onCityChange:t}=e,[n,r]=l.useState(!1),[o,i]=l.useState(""),c=function(e,a){let[t,s]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let a=setTimeout(()=>{s(e)},500);return()=>{clearTimeout(a)}},[e,500]),t}(o,500),[d,m]=l.useState([]),[u,p]=l.useState(!1),[h,j]=l.useState(null);l.useEffect(()=>{if(c.length<2)return void m([]);(async()=>{p(!0),j(null);try{let e=await fetch("https://geocoding-api.open-meteo.com/v1/search?name=".concat(c,"&count=5&language=pl&format=json"));if(!e.ok)throw Error("Nie udało się wyszukać miast.");let a=await e.json();m(a.results||[])}catch(e){j(e instanceof Error?e.message:"Wystąpił błąd."),m([])}finally{p(!1)}})()},[c]);let g=e=>{let a=d.find(a=>"".concat(a.name,", ").concat(a.country).toLowerCase()===e.toLowerCase());a&&(t(a),r(!1),i(""),m([]))};return(0,s.jsxs)(et,{open:n,onOpenChange:r,children:[(0,s.jsx)(es,{asChild:!0,children:(0,s.jsxs)(x.$,{variant:"outline",role:"combobox","aria-expanded":n,className:"w-full justify-between",children:[a?"".concat(a.name,", ").concat(a.country):"Wybierz miasto...",(0,s.jsx)(P.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,s.jsx)(el,{className:"w-[200px] p-0",children:(0,s.jsxs)(q,{children:[(0,s.jsx)(H,{placeholder:"Szukaj miasta...",value:o,onValueChange:i}),(0,s.jsxs)($,{children:[u&&(0,s.jsx)("div",{className:"p-2 flex justify-center",children:(0,s.jsx)(T.A,{className:"h-6 w-6 animate-spin"})}),h&&(0,s.jsx)(X,{children:h}),!u&&!h&&0===d.length&&c.length>1&&(0,s.jsx)(X,{children:"Nie znaleziono miast."}),(0,s.jsx)(Q,{children:d.map(e=>(0,s.jsxs)(ee,{onSelect:g,value:"".concat(e.name,", ").concat(e.country),children:[(0,s.jsx)(U.A,{className:(0,f.cn)("mr-2 h-4 w-4",(null==a?void 0:a.id)===e.id?"opacity-100":"opacity-0")}),e.name,", ",e.country]},e.id))})]})]})})]})}el.displayName=ea.UC.displayName;let er={0:{condition:"Słonecznie",icon:Z.A},1:{condition:"Gł\xf3wnie bezchmurnie",icon:Z.A},2:{condition:"Częściowe zachmurzenie",icon:L.A},3:{condition:"Pochmurno",icon:L.A},45:{condition:"Mgła",icon:L.A},48:{condition:"Mgła osadzająca szron",icon:L.A},51:{condition:"Lekka mżawka",icon:D.A},53:{condition:"Umiarkowana mżawka",icon:D.A},55:{condition:"Gęsta mżawka",icon:D.A},56:{condition:"Lekka marznąca mżawka",icon:D.A},57:{condition:"Gęsta marznąca mżawka",icon:D.A},61:{condition:"Lekki deszcz",icon:D.A},63:{condition:"Umiarkowany deszcz",icon:D.A},65:{condition:"Silny deszcz",icon:D.A},66:{condition:"Lekki marznący deszcz",icon:D.A},67:{condition:"Silny marznący deszcz",icon:D.A},71:{condition:"Lekkie opady śniegu",icon:O.A},73:{condition:"Umiarkowane opady śniegu",icon:O.A},75:{condition:"Silne opady śniegu",icon:O.A},77:{condition:"Opady śniegu",icon:O.A},80:{condition:"Lekkie przelotne opady",icon:D.A},81:{condition:"Umiark. przelotne opady",icon:D.A},82:{condition:"Silne przelotne opady",icon:D.A},85:{condition:"Lekkie opady śniegu",icon:O.A},86:{condition:"Silne opady śniegu",icon:O.A},95:{condition:"Burza",icon:D.A},96:{condition:"Burza z gradem",icon:D.A},99:{condition:"Burza z silnym gradem",icon:D.A}},eo={id:3088171,name:"Lublin",latitude:51.25,longitude:22.57,country:"Poland"},ei=()=>{try{let e=localStorage.getItem("selectedCity");return e?JSON.parse(e):eo}catch(e){return console.error("Could not parse saved city from localStorage",e),eo}};function ec(e){let{onForecastChange:a}=e,[t,n]=(0,l.useState)(""),[r,o]=(0,l.useState)(null),[i,d]=(0,l.useState)(null),[m,u]=(0,l.useState)(!0),[x,p]=(0,l.useState)(null);return(0,l.useEffect)(()=>{o(ei())},[]),(0,l.useEffect)(()=>{let e=setInterval(()=>{n(new Date().toLocaleTimeString("pl-PL"))},1e3);return n(new Date().toLocaleTimeString("pl-PL")),()=>clearInterval(e)},[]),(0,l.useEffect)(()=>{if(!r)return;let e=async()=>{u(!0),p(null);try{let e=await fetch("https://api.open-meteo.com/v1/forecast?latitude=".concat(r.latitude,"&longitude=").concat(r.longitude,"&current=temperature_2m,apparent_temperature,weather_code,wind_speed_10m,wind_direction_10m"));if(!e.ok)throw Error("Nie udało się pobrać prognozy.");let t=await e.json(),s=er[t.current.weather_code]||{condition:"Nieznana pogoda",icon:I.A},l={city:r.name,temperature:t.current.temperature_2m,condition:s.condition,icon:s.icon,apparentTemperature:t.current.apparent_temperature,windSpeed:t.current.wind_speed_10m,windDirection:t.current.wind_direction_10m};d(l),a(l)}catch(e){p(e instanceof Error?e.message:"Wystąpił błąd."),d(null),a(null)}finally{u(!1)}};e();let t=setInterval(e,3e5);return()=>clearInterval(t)},[r,a]),(0,s.jsxs)(c.Zp,{className:"col-span-1 sm:col-span-2 md:col-span-3 lg:col-span-2",children:[(0,s.jsx)(c.aR,{className:"pb-2",children:(0,s.jsxs)(c.ZB,{className:"text-base font-medium flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[(0,s.jsx)("div",{className:"flex-grow",children:(0,s.jsx)(en,{selectedCity:r,onCityChange:e=>{o(e);try{localStorage.setItem("selectedCity",JSON.stringify(e))}catch(e){console.error("Could not save city to localStorage",e)}}})}),(0,s.jsx)("span",{className:"text-sm font-normal text-muted-foreground self-end sm:self-center",children:t})]})}),(0,s.jsx)(c.Wu,{children:(()=>{if(m&&!i)return(0,s.jsx)("div",{className:"flex items-center justify-center h-24",children:(0,s.jsx)(F.A,{className:"h-8 w-8 animate-spin"})});if(x)return(0,s.jsx)("div",{className:"flex items-center justify-center h-24 text-destructive text-sm",children:x});if(i){let e=i.icon;return(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-3xl sm:text-4xl font-bold",children:[i.temperature.toFixed(1),"\xb0C"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:i.condition})]}),(0,s.jsx)(e,{className:"h-12 w-12 sm:h-16 sm:w-16 text-yellow-400"})]})}return null})()})]})}function ed(e){let{forecast:a}=e,{emoji:t,message:l}=(()=>{if(!a)return{emoji:"\uD83E\uDD14",message:"Brak danych do rekomendacji."};let{apparentTemperature:e,windSpeed:t}=a,s="",l="☀️";return e<5?(l="\uD83E\uDDE5",s="Ubierz się ciepło! Kurtka zimowa i czapka będą idealne."):e>=5&&e<18?(l="\uD83D\uDC55",s="Wystarczy bluza lub lekka kurtka. Ubierz się warstwowo."):(l="☀️",s="Idealna pogoda na kr\xf3tki rękaw!"),t>15&&(s+=" Pamiętaj o czymś wiatroszczelnym."),{emoji:l,message:s}})();return(0,s.jsxs)(c.Zp,{className:"col-span-1 sm:col-span-2 md:col-span-1 lg:col-span-2",children:[(0,s.jsx)(c.aR,{className:"pb-2",children:(0,s.jsx)(c.ZB,{className:"text-base font-medium",children:"Jak się ubrać?"})}),(0,s.jsx)(c.Wu,{children:(0,s.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,s.jsx)("span",{className:"text-4xl sm:text-5xl w-16 text-center",children:t}),(0,s.jsx)("p",{className:"text-sm font-medium text-left flex-1",children:l})]})})]})}function em(e){let{value:a,min:t=0,max:l=100,ranges:n}=e;if(null==a)return(0,s.jsx)("div",{className:"mt-4 h-12 flex items-center justify-center text-muted-foreground",children:"Brak danych"});let r=n.filter(e=>e.end>e.start),o=l-t,i=Math.max(0,Math.min(100,(a-t)/o*100));return(0,s.jsxs)("div",{className:"mt-4 w-full",children:[(0,s.jsx)("div",{className:"relative h-4 w-full rounded-full overflow-hidden flex",children:r.map((e,a)=>{let t=e.end-e.start;return(0,s.jsx)("div",{className:(0,f.cn)("h-full",e.color),style:{width:"".concat(t/o*100,"%")}},a)})}),(0,s.jsxs)("div",{className:"relative w-full h-8",children:[(0,s.jsx)("div",{className:"absolute top-0 transform -translate-x-1/2",style:{left:"".concat(i,"%")},children:(0,s.jsx)("div",{className:"w-0 h-0  border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-foreground "})}),(0,s.jsx)("div",{className:"absolute top-3 w-full flex justify-between px-1",children:r.map((e,a)=>{let l=e.end-e.start,n=(e.start+l/2-t)/o*100;return(0,s.jsx)("span",{className:"text-xs text-muted-foreground",style:{position:"absolute",left:"".concat(n,"%"),transform:"translateX(-50%)"},children:e.label},a)})})]})]})}function eu(e){let{title:a,value:t,unit:l,icon:n,description:r}=e;return(0,s.jsxs)(c.Zp,{className:"transition-all hover:shadow-lg hover:-translate-y-1",children:[(0,s.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(c.ZB,{className:"text-sm font-medium",children:a}),n]}),(0,s.jsxs)(c.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:"N/A"!==t?"".concat(t," ").concat(l):"N/A"}),r&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function ex(e){let{currentWeather:a}=e,{emoji:t,message:l}=(()=>{if(!a)return{emoji:"\uD83E\uDD14",message:"Brak danych do rekomendacji."};let{temperature:e,humidity:t}=a;return e>25?{emoji:"\uD83E\uDD75",message:"Gorąco! Rozważ otwarcie okna."}:e<18?{emoji:"\uD83E\uDD76",message:"Chłodno. Może warto zamknąć okno?"}:t>65?{emoji:"\uD83D\uDCA7",message:"Wysoka wilgotność. Warto przewietrzyć."}:{emoji:"\uD83C\uDF89",message:"Idealne warunki w pomieszczeniu!"}})();return(0,s.jsxs)(c.Zp,{className:"col-span-1 sm:col-span-2 md:col-span-1 lg:col-span-2",children:[(0,s.jsx)(c.aR,{className:"pb-2",children:(0,s.jsx)(c.ZB,{className:"text-base font-medium",children:"Zalecenia (Stacja)"})}),(0,s.jsx)(c.Wu,{children:(0,s.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,s.jsx)("span",{className:"text-4xl sm:text-5xl w-16 text-center",children:t}),(0,s.jsx)("p",{className:"text-sm font-medium text-left flex-1",children:l})]})})]})}var ep=t(53838);let ef={alder_pollen:"Olcha",birch_pollen:"Brzoza",grass_pollen:"Trawy",mugwort_pollen:"Bylica",ragweed_pollen:"Ambrozja"},eh=e=>e<1?{level:"Brak",className:"text-green-500"}:e<20?{level:"Niski",className:"text-yellow-500"}:e<50?{level:"Średni",className:"text-orange-500"}:e<100?{level:"Wysoki",className:"text-red-500"}:{level:"Bardzo wysoki",className:"text-purple-500"};function ej(){let[e,a]=(0,l.useState)(null),[t,n]=(0,l.useState)(!0),[r,o]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=async()=>{n(!0),o(null);try{let e=Object.keys(ef).join(","),t=await fetch("https://air-quality-api.open-meteo.com/v1/air-quality?latitude=51.25&longitude=22.57&current=".concat(e));if(!t.ok)throw Error("Nie udało się pobrać danych o pyłkach.");let s=(await t.json()).current,l=-1,n="Brak";for(let e of Object.keys(ef))s.hasOwnProperty(e)&&s[e]>l&&(l=s[e],n=ef[e]);l<=0&&(l=0,n="Brak");let{level:r,className:o}=eh(l);a({level:r,value:l,dominantPollen:n,className:o})}catch(e){o(e instanceof Error?e.message:"Wystąpił błąd."),a(null)}finally{n(!1)}};e();let t=setInterval(e,36e5);return()=>clearInterval(t)},[]),(0,s.jsxs)(c.Zp,{className:"transition-all hover:shadow-lg hover:-translate-y-1",children:[(0,s.jsx)(c.aR,{className:"pb-2",children:(0,s.jsx)(c.ZB,{className:"text-sm font-medium",children:"Pylenie"})}),(0,s.jsx)(c.Wu,{children:t?(0,s.jsx)("div",{className:"flex items-center justify-center h-24",children:(0,s.jsx)(F.A,{className:"h-8 w-8 animate-spin"})}):r?(0,s.jsx)("div",{className:"flex items-center justify-center h-24 text-destructive text-sm",children:r}):e?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,s.jsx)(ep.A,{className:(0,f.cn)("h-12 w-12 mb-2",e.className)}),(0,s.jsx)("p",{className:(0,f.cn)("text-2xl font-bold",e.className),children:e.level}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Brak"!==e.dominantPollen?"Gł\xf3wnie: ".concat(e.dominantPollen," (").concat(e.value.toFixed(0)," p/m\xb3)"):"Brak istotnego pylenia"})]}):null})]})}let eg=[{label:"Ostatnie dane",value:0},{label:"10 sekund",value:10},{label:"30 sekund",value:30},{label:"1 minuta",value:60},{label:"3 minuty",value:180},{label:"10 minut",value:600},{label:"30 minut",value:1800},{label:"1 godzina",value:3600},{label:"3 godziny",value:10800},{label:"1 dzień",value:86400},{label:"3 dni",value:259200},{label:"1 tydzień",value:604800},{label:"1 miesiąc",value:2592e3},{label:"3 miesiące",value:7776e3}],ey=e=>{var a;if(e.length<2)return e;let t=null==(a=e.find(e=>void 0!==e.pressure))?void 0:a.pressure;return void 0===t?e:e.map(e=>void 0===e.pressure?e:Math.abs(e.pressure-t)>5?{...e,pressure:t}:(t=e.pressure,e))},ew=e=>{if(e.length<=1e3)return e;let a=[],t=Math.floor(e.length/1e3);for(let s=0;s<e.length;s+=t)a.push(e[s]);return a[a.length-1]!==e[e.length-1]&&a.push(e[e.length-1]),a};function eN(){var e;let a=(0,o.tm)(),[t,n]=(0,l.useState)([]),[p,f]=(0,l.useState)("stacja1"),[g,y]=(0,l.useState)(null),[Z,L]=(0,l.useState)([]),[D,O]=(0,l.useState)(!0),[I,F]=(0,l.useState)(600),[P,T]=(0,l.useState)(!1),[U,M]=(0,l.useState)(null),J=(0,l.useRef)(Date.now()),G=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!a)return void console.error("Brak połączenia z bazą danych");let e=(0,i.KR)(a,"users"),t=(0,i.Zy)(e,e=>{if(e.exists()){let a=Object.keys(e.val());n(a),a.includes(p)||f(a.length>0?a[0]:"")}else n([]),f(""),console.warn("Brak skonfigurowanych stacji")},e=>{console.error("Could not fetch station list:",e)});return()=>t()},[a,p]),(0,l.useEffect)(()=>{if(O(!0),y(null),L([]),G.current=null,J.current=Date.now(),T(!0),!a||!p)return void O(!1);let e=(0,i.KR)(a,"users/".concat(p,"/current_weather")),t=(0,i.Zy)(e,e=>{let a=e.val();e.exists()&&(null==a?void 0:a.timestamp)?G.current!==a.timestamp&&(y(a),T(!1),J.current=Date.now(),G.current=a.timestamp):T(!0),O(!1)},e=>{console.error("Firebase read error (current):",e),T(!0),O(!1)}),s=(0,i.KR)(a,"users/".concat(p,"/weather_data")),l=(0,i.Zy)(s,e=>{e.exists()?L(Object.entries(e.val()).map(e=>{let[a,t]=e;return{id:a,...t,timestamp:new Date(t.timestamp).toISOString()}}).sort((e,a)=>new Date(e.timestamp).getTime()-new Date(a.timestamp).getTime())):L([])},e=>{console.error("Firebase read error (historical):",e),L([])});return()=>{t(),l()}},[a,p]);let{historicalWeather:K,samplingInterval:V}=(0,l.useMemo)(()=>{let e=Z;if(0!==I){let a=Date.now()-1e3*I;e=Z.filter(e=>new Date(e.timestamp).getTime()>=a)}"stacja2"===p&&(e=ey(e));let a=e.length>1e3,t=a?Math.floor(e.length/1e3):null;return{historicalWeather:a?ew(e):e,samplingInterval:t}},[Z,I,p]);(0,l.useEffect)(()=>{let e=setInterval(()=>{Date.now()-J.current>12e3&&!P&&(T(!0),console.warn("Brak sygnału ze stacji!"))},2e3);return()=>clearInterval(e)},[P]);let Y="stacja2"===p,q=!g||P,H=(e=>{if(void 0===e)return{icon:null,label:"N/A"};let a=Math.round(e/45)%8;return{icon:(0,s.jsx)(B.A,{style:{transform:"rotate(".concat(e,"deg)")},className:"h-4 w-4 text-muted-foreground"}),label:["N","NE","E","SE","S","SW","W","NW"][a]}})(null==U?void 0:U.windDirection);return(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-background",children:[(0,s.jsx)(d.Y,{}),(0,s.jsxs)("main",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-end gap-4",children:[(0,s.jsxs)("div",{className:"max-w-xs flex-grow",children:[(0,s.jsx)(S.J,{htmlFor:"station-select",children:"Wybierz stację"}),(0,s.jsxs)(u.l6,{onValueChange:f,value:p,children:[(0,s.jsx)(u.bq,{id:"station-select",className:"w-full",children:(0,s.jsx)(u.yv,{placeholder:"Wybierz stację..."})}),(0,s.jsx)(u.gC,{children:t.length>0?t.map(e=>(0,s.jsx)(u.eb,{value:e,children:e},e)):(0,s.jsx)(u.eb,{value:"loading",disabled:!0,children:"Ładowanie stacji..."})})]})]}),(0,s.jsxs)("div",{className:"max-w-xs flex-grow",children:[(0,s.jsx)(S.J,{htmlFor:"limit-select",children:"Zakres danych"}),(0,s.jsxs)(u.l6,{onValueChange:e=>F(Number(e)),value:String(I),children:[(0,s.jsx)(u.bq,{id:"limit-select",className:"w-full",children:(0,s.jsx)(u.yv,{})}),(0,s.jsx)(u.gC,{children:eg.map(e=>(0,s.jsx)(u.eb,{value:String(e.value),children:e.label},e.value))})]})]}),(0,s.jsxs)(h,{children:[(0,s.jsx)(j,{asChild:!0,children:(0,s.jsxs)(x.$,{variant:"outline",disabled:!p||0===Z.length,children:[(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Wyczyść wykresy"]})}),(0,s.jsxs)(w,{children:[(0,s.jsxs)(N,{children:[(0,s.jsx)(v,{children:"Czy na pewno chcesz wyczyścić historię?"}),(0,s.jsxs)(k,{children:["Ta akcja trwale usunie wszystkie dane historyczne dla stacji"," ",(0,s.jsx)("span",{className:"font-bold",children:p}),". Wykresy zaczną się rysować od nowa. Tej operacji nie można cofnąć."]})]}),(0,s.jsxs)(b,{children:[(0,s.jsx)(A,{children:"Anuluj"}),(0,s.jsx)(z,{onClick:()=>{if(!a||!p)return void console.error("Baza danych lub stacja nie została wybrana.");let e=(0,i.KR)(a,"users/".concat(p,"/weather_data"));(0,i.TF)(e).then(()=>{console.log("Historia dla stacji ".concat(p," została wyczyszczona."))}).catch(e=>{console.error("Nie udało się wyczyścić historii:",e)})},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Wyczyść"})]})]})]}),(0,s.jsx)(r(),{href:"/dashboard/charts?station=".concat(p),passHref:!0,target:"_blank",children:(0,s.jsxs)(x.$,{variant:"outline",disabled:!p||0===Z.length,children:[(0,s.jsx)(R.A,{className:"mr-2 h-4 w-4"}),"Otw\xf3rz w nowym oknie"]})}),(0,s.jsx)(r(),{href:"/",passHref:!0,children:(0,s.jsxs)(x.$,{variant:"outline",children:[(0,s.jsx)(_.A,{className:"mr-2 h-4 w-4"}),"Powr\xf3t do menu"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:[(0,s.jsxs)(c.Zp,{className:"col-span-1",children:[(0,s.jsx)(c.aR,{children:(0,s.jsx)(c.ZB,{children:"Temperatura"})}),(0,s.jsxs)(c.Wu,{children:[D&&q?(0,s.jsx)("p",{className:"text-2xl font-bold",children:"Ładowanie..."}):(0,s.jsx)("p",{className:"text-4xl font-bold",children:q?"Brak danych":"".concat(g.temperature.toFixed(1)," \xb0C")}),(0,s.jsx)(em,{value:q?null:g.temperature,min:-10,max:40,ranges:[{color:"bg-blue-800",label:"Zimno",start:-10,end:18},{color:"bg-sky-500",label:"OK",start:18,end:25},{color:"bg-orange-500",label:"Gorąco",start:25,end:40}]})]})]}),(0,s.jsxs)(c.Zp,{className:"col-span-1",children:[(0,s.jsx)(c.aR,{children:(0,s.jsx)(c.ZB,{children:"Wilgotność"})}),(0,s.jsxs)(c.Wu,{children:[D&&q?(0,s.jsx)("p",{className:"text-2xl font-bold",children:"Ładowanie..."}):(0,s.jsx)("p",{className:"text-4xl font-bold",children:q?"Brak danych":"".concat(g.humidity.toFixed(1)," %")}),(0,s.jsx)(em,{value:q?null:g.humidity,min:0,max:100,ranges:[{color:"bg-orange-500",label:"Sucho",start:0,end:40},{color:"bg-sky-500",label:"OK",start:40,end:60},{color:"bg-blue-800",label:"Wilgotno",start:60,end:100}]})]})]}),Y&&(0,s.jsxs)(c.Zp,{className:"col-span-1",children:[(0,s.jsx)(c.aR,{children:(0,s.jsx)(c.ZB,{children:"Ciśnienie"})}),(0,s.jsxs)(c.Wu,{children:[D&&q?(0,s.jsx)("p",{className:"text-2xl font-bold",children:"Ładowanie..."}):(0,s.jsx)("p",{className:"text-4xl font-bold",children:q||void 0===g.pressure?"Brak danych":"".concat(g.pressure.toFixed(0)," hPa")}),(0,s.jsx)(em,{value:q||void 0===g.pressure?null:g.pressure,min:960,max:1050,ranges:[{color:"bg-orange-500",label:"Niskie",start:960,end:1e3},{color:"bg-sky-500",label:"Normalne",start:1e3,end:1025},{color:"bg-blue-800",label:"Wysokie",start:1025,end:1050}]})]})]}),(0,s.jsx)(ec,{onForecastChange:M}),(0,s.jsx)(eu,{title:"Odczuwalna",icon:(0,s.jsx)(W.A,{className:"h-4 w-4 text-muted-foreground"}),value:U?U.apparentTemperature.toFixed(1):"N/A",unit:"\xb0C"}),(0,s.jsx)(eu,{title:"Wiatr",icon:null!=(e=H.icon)?e:(0,s.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"}),value:U?U.windSpeed.toFixed(1):"N/A",unit:"km/h",description:H.label}),(0,s.jsx)(ej,{}),(0,s.jsx)(ed,{forecast:U}),(0,s.jsx)(ex,{currentWeather:q?null:g})]}),(0,s.jsx)(m.w,{weatherData:K,isLoading:D&&0===Z.length,hasPressureData:Y,timeRange:I,samplingInterval:V})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,507,644,874,743,38,140,124,673,441,684,358],()=>a(44680)),_N_E=e.O()}]);